#!/bin/bash
# Add org file changes to the repository

export PATH="/home/matus/.local/bin:/usr/local/bin:/usr/bin:/bin:$PATH"

echo "Repository: org"
cd ~/org
# Remove deleted files
git ls-files --deleted -z | xargs -r -0 git rm
# Add new files
git add .
git commit -m "parmenides: $(date --iso-8601=seconds)"
git push origin parmenides

echo "Repository: Annex data"
cd ~/data/
git add -u documents/ >/dev/null 2>&1
git add documents/journal.org.gpg >/dev/null 2>&1
echo "===== $(date --iso-8601=seconds) =====" >> /home/matus/git-annex.log
git commit -m "parmenides: $(date --iso-8601=seconds)" &>> /home/matus/git-annex.log
git annex sync --content -J10 &>> /home/matus/git-annex.log

# if [[ -d /media/data-750/data/ ]] ; then
#     echo "Repository: Annex data - media"
#     cd /media/data-750/data/
#     git annex sync &>> /home/matus/git-annex.log
# fi
